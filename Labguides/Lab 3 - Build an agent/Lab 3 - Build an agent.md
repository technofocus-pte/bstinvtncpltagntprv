# **Lab 3: Build an agent in Microsoft Copilot Studio with the new AI capabilities**

**Objective**: In this lab, you'll create an agent using Microsoft
Copilot Studio with the new AI capabilities. This agent is part of the
Real Estate solution and is used to schedule showings.

## **Exercise 1: Create an agent with the new AI capabilities**

### **Task 1: Create an agent**

1.  Sign in to **Microsoft Copilot Studio** with your **Office 365 admin
    tenant** credentials
    using !!https://go.microsoft.com/fwlink/?LinkId=2107702!!

     ![A screenshot of a computer AI-generated content may be incorrect.](./media/image1.png)

2.  Fill in the following required information and then select **Get
    Started**.

     **Country or Region** – United States
    
     **Job title** – Your job title
    
     **Business phone number** – Your phone number
    
     ![A screenshot of a computer AI-generated content may be incorrect.](./media/image2.png)

3.  Under the **Confirmation details** step, select **Get Started**.

     ![A screenshot of a computer AI-generated content may be incorrect.](./media/image3.png)

4.  Select the **United States** as your country/region and then
    select **Get** **Started**.

     ![](./media/image4.png)

5.  If you see the pop-up regarding the latest version of Copilot
    Studio, select **Got it**.

     ![](./media/image5.png)

6.  Select the **Dev One** environment from the environment selector.

     ![A screenshot of a computer AI-generated content may be incorrect.](./media/image6.png)

     **Note**: If you're unable to select the **Dev One** environment as shown in the image below, then follow the steps            below.

     ![](./media/image7.png)

     Open the Power Platform Admin Center using !!https://admin.powerplatform.microsoft.com/!!. From the left-hand menu,          select **Manage**, then choose **Environments** > **Dev One**. Copy the **Environment ID**, and update the Copilot           Studio link accordingly, as shown in the image below.

     ![image](./media/image8.png)

     Navigate back to the Copilot Studio tab and open !!https://copilotstudio.microsoft.com/environments/< EnvironmentID          >/home)!! (Replacing **< EnvironmentID >** with the value fetched above)

     ![](./media/image9.png)

7.  On the **Welcome to Copilot Studio** pop-up, select **Skip.**

     ![A screenshot of a computer AI-generated content may be incorrect.](./media/image10.png)

8.  On the **Home** page, select **Agents** from the left navigation
    pane.

     ![](./media/image11.png)

9.  Select **+Create blank agent**.

     ![](./media/image12.png)

10. Wait till you see the message as **Your agent has been
    provisioned**.

     ![](./media/image13.png)

11. In the **Details** section, select **Edit**.

     ![](./media/image14.png)

12. Name your agent as !!Real Estate Booking Service!!. Select **Save**.

     ![](./media/image15.png)

13. In the **Instruction** section, select **Edit**.

     ![](./media/image16.png)

14. Enter the given information under the Instructions field and then
    select **Save**.

     !!Use a friendly yet professional tone.!!
    
     !!Don't talk about any public real estate companies.!!
    
     ![](./media/image17.png)

15. Select **+Add knowledge**.

     ![](./media/image18.png)

16. Select **Dataverse**.

     ![](./media/image19.png)

17. Search for and select the +++**Showing**+++ table. Select **Add to
    agent**.

     ![](./media/image20.png)

## **Exercise 2**: **Create a topic using Copilot**

### **Task 1: Create a topic using Copilot**

1.  Select **Topics** from the top bar.

     **Note**: Due to the screen resolution, you may not see the **Topics**
     tabs. Select +8 (Number may vary in your case) and then Topics.
    
     ![](./media/image21.png)

2.  Select **+ Add a topic** > **Create from description with
    Copilot**.

     ![](./media/image22.png)

3.  In the new window that appears: In the **Name your topic** field, enter: !!Book a Real Estate Showing!!.

4.  In the **Create a topic to...** field, enter:

     Let someone book a real estate showing providing their full name, email, address of the property, and date and time of       the showing.

5.  Select **Create**.

     ![](./media/image23.png)

6.  You should see a new topic generated by the agent, along with
    multiple question nodes, entity selection, and variable naming.
    Close the **Test your agent** pane for more visibility.

     ![](./media/image24.png)

7.  You should now see a topic generated with:

     A **Trigger node** for queries like book a real estate showing or schedule a property visit

     **Question nodes** requesting the user's:
    
     Full name
    
     Email address
    
     Property address
    
     Date and time of the showing
    
     A **Message node** confirming the booking
    
     ![](./media/image25.png)

### **Task 2: Edit a topic**

1.  Locate the question node titled **What is your email address?** and
    select it.

     ![](./media/image26.png)

2.  Enter !!Thank you!! in the message box before 'What is your email address' and then select the {X} icon to insert the        variable. Select **FullName** variable.

     ![](./media/image27.png)

3.  Select the **+ icon** after the last node in the topic.

     ![](./media/image28.png)

4.  Select **Ask with adaptive card**.

     ![](./media/image29.png)

5.  Select the three dots **(…)** of the node, and then
    select **Properties**.

     ![](./media/image30.png)

6.  The **Adaptive Card Node properties** pane will open on the right
    side of the screen. Select **Edit adaptive card**.

     ![](./media/image31.png)

7.  In the **Card payload editor** pane, replace the default payload
    with the JSON literal for your card.

    ``` 

        {
        "type": "AdaptiveCard",
        "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
        "version": "1.5",
        "body": 
        [
            {
                "type": "TextBlock",
                "size": "Medium",
                "weight": "Bolder",
                "text": "Summary"    
            },
            {
                "type": "FactSet",
                "facts": 
                [
                    {
                        "title":"Full Name",
                        "value": "Text(Topic.FullName)"
                    },
                    {
                        "title": "Email Address",
                        "value": "Text(Topic.EmailAddress)"
                    },
                    {
                        "title": "Property Address",
                        "value": "Text(Topic.PropertyAddress)"
                    },
                    {
                        "title": "Date and Time",
                        "value": "Text(Topic.ShowingDateTime)"
                    }
                ]
            },
            {
                "type": "TextBlock",
                "text": "Thank you for providing the information."
            }
        ],
        "actions": [{
          "type": "Action.Submit",
          "title": "Submit"
        }
      ]
    }

    ``` 

     ![](./media/image32.png)

8.  Select **Save**, and then after saving, select **Close**.

     ![](./media/image33.png)

9.  In the **Adaptive Card Node properties** panel, switch
    to **Formula**. Selecting **Formula** automatically converts the
    JSON representation of your card into a Power Fx formula.

     ![](./media/image34.png)

10. In the **Adaptive Card properties**, select the **diagonal arrow**
    icon to expand the card formula.

     ![](./media/image35.png)

11. Remove the **“”** in the value field of Full name, Email address,
    Property address and Date and time of the showing. For example –
    From “Text(Topic.FullName)” to Text(Topic.FullName)

     ![](./media/image36.png)

12. Close the **Formula card**.

     ![](./media/image37.png)

13. Close both **Adaptive Card properties** panes by selecting
    the **X**. You should be back on the **Edit with Copilot** panel.

     ![](./media/image38.png)

14. Select **+ sign** after the last node and select **Ask a
    question** to add one more question node.

     ![](./media/image39.png)

15. Enter !!Do you want to visit again?!!.

     ![](./media/image40.png)

16. Select **Multiple choice option** under **Identity**, click
    on **+New option** and enter !!Yes!! and !!No!! separately by
    selecting **+New option** twice.

     ![](./media/image41.png)

17. In the top-right of the screen, select **Save** to save your topic.

     ![](./media/image42.png)

## **Exercise 3: Test the agent**

1.  Once saved, select **Test** in the top-right of the screen to open
    the **Test your copilot** pane.

     ![](./media/image43.png)

2.  The **Conversation Start** message will appear, and your copilot
    will start a conversation. In response, enter a trigger phrase for
    the topic that you've created and then select the **send** icon.

     !!I want to book a real estate showing!!

     ![](./media/image44.png)

3.  Your copilot should respond with the "What is your full name?"
    question:

     ![](./media/image45.png)

4.  Input responses as prompted using the following information.

     **Full name**: !!Brooke Gray!!
    
     **Email address**: !!abc@example.com!! 
    
     **Address**: !!555 Oak Lane, Denver, CO 80203!! 
    
     **Date and Time**: Any future date, 10:00 AM (For example – !!23/02/2026 10:00 AM!!)
    
     ![](./media/image46.png)

5.  Once all inputs are collected, the Adaptive Card displays a summary.

     ![](./media/image47.png)

6.  Select **Submit**.

     ![](./media/image48.png)

7.  Select **No** on Do you want to visit again.

     ![](./media/image49.png)

8.  To check the knowledge source, enter the prompt: !!List out the real estate properties!!.

     ![](./media/image50.png)

9.  Using the Dataverse table given as a knowledge source, the agent has
    provided some information.

     ![](./media/image51.png)

